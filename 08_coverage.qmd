# –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞

–ö–∞–∫ –∏ –≤ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞—Ö –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è, –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ –Ω–∞–¥ –º–æ—Ä—Ñ–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–º–∏ –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä–∞–º–∏ –Ω–∞–º –Ω—É–∂–Ω–∞ –Ω–µ–∫–æ—Ç–æ—Ä–∞—è –º–µ—Ä–∞, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∫–∞–∂–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ –ø–æ–ª—É—á–∏–≤—à–µ–≥–æ—Å—è —Ç—Ä–∞–Ω—Å–¥—å—é—Å–µ—Ä–∞. –ú–æ—Ä—Ñ–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä—ã –º–æ–≥—É—Ç –¥–µ–ª–∞—Ç—å —ç—Ç–æ –Ω–∞ –º–∞—Ç–µ—Ä–∏–∞–ª–µ –Ω–µ–∫–æ—Ç–æ—Ä–æ–≥–æ –∫–æ—Ä–ø—É—Å–∞. –í –∫–∞—á–µ—Å—Ç–≤–µ –∏–≥—Ä—É—à–µ—á–Ω–æ–≥–æ –ø—Ä–∏–º–µ—Ä–∞ –º—ã —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º —Å–ª–µ–¥—É—é—â–∏–π –∫–æ—Ä–ø—É—Å, —Å–æ—Å—Ç–æ—è—â–∏–π –∏–∑ –ø–æ—Ä–æ—à–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –Ω–∏–∫–æ–º –ö–∏—Å—ã—á–µ–≤:

```{{shell}}
$ cat corpus.txt
```

```{r}
system("cat examples/08_corpus.txt", intern = TRUE) |> 
  cat(sep = "\n")
```

–î–ª—è —Ü–µ–ª–µ–π –¥–∞–Ω–Ω–æ–≥–æ –∑–∞–Ω—è—Ç–∏—è –º—ã —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º —Å–ª–µ–¥—É—é—â–∏–π –∏–≥—Ä—É—à–µ—á–Ω—ã–π —Ç—Ä–∞–Ω—Å–¥—å—é—Å–µ—Ä:

```{{shell}}
$ cat example.lexd
```

```{r}
system("cat examples/08_example.lexd", intern = TRUE) |> 
  cat(sep = "\n")
```

–°–∫–æ–º–ø–∏–ª–∏—Ä—É–µ–º –Ω–∞—à —Ç—Ä–∞–Ω—Å–¥—å—é—Å–µ—Ä:

```{{shell}}
$ lexd example.lexd | hfst-txt2fst | hfst-invert | hfst-fst2fst -O -o analyzer.hfstol
```

```{r}
system("lexd examples/08_example.lexd | hfst-txt2fst | hfst-invert | hfst-fst2fst -O -o examples/analyzer.hfstol")
```

```{{shell}}
$ cat corpus.txt | hfst-proc -C analyzer.hfstol
```

```{r}
system("cat examples/08_corpus.txt | hfst-proc -C examples/analyzer.hfstol", intern = TRUE) |> 
  cat(sep = "\n")
```

–°—Ä–∞–∑—É –æ—Ç–º–µ—Ç–∏–º –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ –¥–∞–Ω–Ω–æ–≥–æ —Ç—Ä–∞–Ω—Å–¥—å—é—Å–µ—Ä–∞:

-   –æ–Ω –Ω–µ —Ä–∞–∑–±–∏—Ä–∞–µ—Ç –≥–ª–∞–≥–æ–ª—ã;
-   –æ–Ω –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ä–∞–∑–±–æ—Ä –¥–ª—è —Å–∏–Ω—Ç–∞–≥–º—ã `–æ —Ä–æ—Å—Å–∏–∏`, –ø—Ä–∏–ø–∏—Å—ã–≤–∞—è —Å–ª–æ–≤—É *—Ä–æ—Å—Å–∏–∏* —Ä–æ–¥–∏—Ç–µ–ª—å–Ω—ã–π –ø–∞–¥–µ–∂ –≤–º–µ—Å—Ç–æ –ø—Ä–µ–¥–ª–æ–∂–Ω–æ–≥–æ;
-   –≤—Å–µ —Å—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –º—É–∂—Å–∫–æ–≥–æ —Ä–æ–¥–∞ –±—É–¥—É—Ç –∏–º–µ—Ç—å –ª–∏—à–Ω–∏–π —Ä–∞–∑–±–æ—Ä, —Ç–∞–∫ –∫–∞–∫ –≤ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–º —á–∏—Å–ª–µ –Ω–µ —Ä–∞–∑–ª–∏—á–∞—é—Ç—Å—è –∏–º–µ–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∏ –≤–∏–Ω–∏—Ç–µ–ª—å–Ω—ã–π –ø–∞–¥–µ–∂–∏.

## –ü–æ–∫—Ä—ã—Ç–∏–µ

–ü–æ–∫—Ä—ã—Ç–∏–µ (coverage, na√Øve coverage) --- —ç—Ç–æ –ø—Ä–æ—Å—Ç–µ–π—à–∏–π —Å–ø–æ—Å–æ–± –æ—Ü–µ–Ω–∏—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ —Ç—Ä–∞–Ω—Å–¥—å—é—Å–µ—Ä–∞. –ï–≥–æ –≤—ã—Å—á–∏—Ç—ã–≤–∞—é—Ç –∫–∞–∫ –¥–æ–ª—é —Ñ–æ—Ä–º, –∫–æ—Ç–æ—Ä–∞—è —Ä–∞–∑–±–∏—Ä–∞–µ—Ç—Å—è —Ç—Ä–∞–Ω—Å–¥—å—é—Å–µ—Ä–æ–º. –ü–æ—Å—á–∏—Ç–∞–µ–º —Å–∫–æ–ª—å–∫–æ —Ç–æ–∫–µ–Ω–æ–≤ –≤—Å–µ–≥–æ –≤ –∫–æ—Ä–ø—É—Å–µ:

```{{shell}}
$ cat corpus.txt | wc -w
```

```{r}
system("cat examples/08_corpus.txt | wc -w", intern = TRUE) |> 
  cat(sep = "\n")
```

–ü–æ—Å—á–∏—Ç–∞–µ–º, —Å–∫–æ–ª—å–∫–æ —Ç–æ–∫–µ–Ω–æ–≤ –Ω–µ —Ä–∞–∑–±–∏—Ä–∞–µ—Ç —Ç—Ä–∞–Ω—Å–¥—å—é—Å–µ—Ä:

```{{shell}}
$ cat corpus.txt | hfst-proc -C analyzer.hfstol | grep -c "*"
```

```{r}
system('cat examples/08_corpus.txt | hfst-proc -C examples/analyzer.hfstol | grep -c "*"', intern = TRUE) |> 
  cat(sep = "\n")
```

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –ø–æ–∫—Ä—ã—Ç–∏–µ –Ω–∞—à–µ–≥–æ —Ç—Ä–∞–Ω—Å–¥—å—é—Å–µ—Ä–∞ –ø—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç $\frac{17-6}{17} \approx 0.65$. –ù–µ —Å—Ç–æ–∏—Ç —Å–∏–ª—å–Ω–æ –¥–æ–≤–µ—Ä—è—Ç—å —ç—Ç–æ–π –º–µ—Ä–µ, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∞ —Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ –Ω–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ —Ä–∞–∑–±–æ—Ä–∞, —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –∑–∞–≤—ã—à–∞—è –∫–∞—á–µ—Å—Ç–≤–æ.

–ò–Ω–æ–≥–¥–∞ –≤–º–µ—Å—Ç–æ –æ–ø–∏—Å–∞–Ω–Ω–æ–≥–æ –ø–æ–∫—Ä—ã—Ç–∏—è —Å—á–∏—Ç–∞—é—Ç –∞–Ω–∞–ª–æ–≥–∏—á–Ω—É—é –º–µ—Ä—É, —É–¥–∞–ª—è—è –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è —Ç–æ–∫–µ–Ω—ã –∏ —Ä–∞–∑–±–æ—Ä—ã, —á—Ç–æ–±—ã –Ω–µ –ø–æ–ª—É—á–∞–ª–æ—Å—å —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑-–∑–∞ —Ç–æ–≥–æ, —á—Ç–æ —Ç—Ä–∞–Ω—Å–¥—å—é—Å–µ—Ä —Ä–∞–∑–±–∏—Ä–∞–µ—Ç —Å–∞–º—ã–µ —á–∞—Å—Ç–æ—Ç–Ω—ã–µ —Å–ª–æ–≤–∞. –í —Ç–∞–∫–æ–º —Å–ª—É—á–∞–µ, –æ–ø–∏—Å–∞–Ω–Ω—É—é –≤—ã—à–µ –º–µ—Ä—É –Ω–∞–∑—ã–≤–∞—é—Ç coverage~1~, –∞ —Å —É–¥–∞–ª–µ–Ω–∏–µ–º —ç—Ñ—Ñ–µ–∫—Ç–∞ —á–∞—Å—Ç–æ—Ç–Ω–æ—Å—Ç–∏ --- coverage~2~.

## –¢–æ—á–Ω–æ—Å—Ç—å –∏ –ø–æ–ª–Ω–æ—Ç–∞

–¢–æ—á–Ω–æ—Å—Ç—å (precision) –∏ –ø–æ–ª–Ω–æ—Ç–∞ (recall) --- –º–µ—Ç—Ä–∏–∫–∏, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø—Ä–∏ –æ—Ü–µ–Ω–∫–µ –±–æ–ª—å—à–µ–π —á–∞—Å—Ç–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤ –º–∞—à–∏–Ω–Ω–æ–º –æ–±—É—á–µ–Ω–∏–∏. –ò–Ω–æ–≥–¥–∞ –∏—Ö –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Å–∞–º–∏ –ø–æ —Å–µ–±–µ, –∞ –∏–Ω–æ–≥–¥–∞ –≤ –≤–∏–¥–µ –ø—Ä–æ–∏–∑–≤–æ–¥–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫, –Ω–∞–ø—Ä–∏–º–µ—Ä F~1~-–º–µ—Ä—ã. –ù–∞–ø–æ–º–Ω–∏–º, –∫–∞–∫ –≤—ã–≥–ª—è–¥–∏—Ç –º–∞—Ç—Ä–∏—Ü–∞ –æ—à–∏–±–æ–∫ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ—Ç–æ—Ä–æ–π —Å—á–∏—Ç–∞—é—Ç—Å—è –º–µ—Ä—ã:

|        |                üêï                |             üêà             |
|:------:|:--------------------------------:|:--------------------------:|
| ü§ñüí≠üêï |    –∏—Å—Ç–∏–Ω–Ω–æ-–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ (TP)    |  –ª–æ–∂–Ω–æ-–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ (FP)  |
| ü§ñüí≠üêà | –ª–æ–∂–Ω–æ-–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã (FN) | –∏—Å—Ç–∏–Ω–Ω–æ-–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ (TN) |

::::: columns
::: column
$$—Ç–æ—á–Ω–æ—Å—Ç—å = \frac{TP}{TP+FP}$$
:::

::: column
$$–ø–æ–ª–Ω–æ—Ç–∞ = \frac{TP}{TP+FN}$$
:::
:::::

$$F_1 = 2\times\frac{—Ç–æ—á–Ω–æ—Å—Ç—å \times –ø–æ–ª–Ω–æ—Ç–∞}{—Ç–æ—á–Ω–æ—Å—Ç—å + –ø–æ–ª–Ω–æ—Ç–∞} = \frac{2\times TP}{2\times TP+FP+FN}$$

–í –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–∏ –∫ –º–æ—Ä—Ñ–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–º—É –∞–Ω–∞–ª–∏–∑—É, –¥–∞–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –¥–æ–ª–∂–Ω—ã —É—á–∏—Ç—ã–≤–∞—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ —Ä–∞–∑–±–æ—Ä–∞, –∞ —ç—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ –Ω–∞–º –Ω—É–∂–Ω–æ –∑–∞–≤–µ—Å—Ç–∏ –∑–æ–ª–æ—Ç–æ–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç, —Å –∫–æ—Ç–æ—Ä—ã–º –º—ã –±—É–¥–µ–º —Å—Ä–∞–≤–Ω–∏–≤–∞—Ç—å. –ó–æ–ª–æ—Ç–æ–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç –Ω–µ –æ–±—è–∑–∞–Ω –∏–º–µ—Ç—å –æ–¥–∏–Ω –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —Ä–∞–∑–±–æ—Ä –¥–ª—è –∫–∞–∂–¥–æ–π —Ñ–æ—Ä–º—ã, –∫–∞–∫ –ª–∏–Ω–≥–≤–∏—Å—Ç—ã –æ–∂–∏–¥–∞—é—Ç –æ—Ç –æ–≥–ª–æ—Å—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞. –ü–æ—ç—Ç–æ–º—É –Ω–∞ –∫–∞–∂–¥—ã–π —Ç–æ–∫–µ–Ω –≤ —Ç–µ–∫—Å—Ç–µ –º—ã –ø–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫ —Ä–∞–∑–±–æ—Ä–æ–≤ –∏–∑ –∑–æ–ª–æ—Ç–æ–≥–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞ –∏ –∏–∑ –Ω–∞—à–µ–≥–æ –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä–∞.

|                    |   –µ—Å—Ç—å –≤ –∑–æ–ª–æ—Ç–æ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–µ  |  –Ω–µ—Ç –≤ –∑–æ–ª–æ—Ç–æ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–µ |
|:------------------:|:---------------------------:|:------------------------:|
| –µ—Å—Ç—å –≤ –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä–µ |        —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è (TP)      |          (FP)            |
| –Ω–µ—Ç –≤ –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä–µ  |            (FN)             |    (TN)[^TNcoment]       |

[^TNcoment]: –¢–∞–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å–ª—É—á–∞–∏, –∫–æ—Ç–æ—Ä—ã–µ —Ü–µ–ª–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–æ –æ—Å—Ç–∞–≤–ª–µ–Ω—ã –Ω–µ—Ä–∞–∑–æ–±—Ä–∞–Ω–Ω—ã–º–∏ –≤ –∑–æ–ª–æ—Ç–æ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–µ –∏ –Ω–µ –±—ã–ª–∏ —Ä–∞–∑–æ–±—Ä–∞–Ω—ã –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä–æ–º.

- –¢–æ—á–Ω–æ—Å—Ç—å (precision) --- –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞–∑–±–æ—Ä–æ–≤ –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä–∞, —Å–æ–≤–ø–∞–¥–∞—é—â–∏—Ö —Å —Ä–∞–∑–±–æ—Ä–æ–º –∑–æ–ª–æ—Ç–æ–≥–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞ (TP), –¥–µ–ª–µ–Ω–Ω–æ–µ –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—Å–µ—Ö —Ä–∞–∑–±–æ—Ä–æ–≤ –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä–∞ (TP + FP).
- –ü–æ–ª–Ω–æ—Ç–∞ (recall) --- –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞–∑–±–æ—Ä–æ–≤ –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä–∞, —Å–æ–≤–ø–∞–¥–∞—é—â–∏—Ö —Å —Ä–∞–∑–±–æ—Ä–æ–º –∑–æ–ª–æ—Ç–æ–≥–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞ (TP), –¥–µ–ª–µ–Ω–Ω–æ–µ –Ω–∞ –∫–æ–ª–∏–µ—Å—Ç–≤–æ —Ä–∞–∑–±–æ—Ä–æ–≤ –≤ –∑–æ–ª–æ—Ç–æ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–µ (TP + FN).

–ö–∞–∫ —Ä–∞–∑–±–æ—Ä –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä–∞ –º–æ–∂–µ—Ç —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å —Ä–∞–∑–±–æ—Ä–æ–º –∑–æ–ª–æ—Ç–æ–≥–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞? –ú–æ–∂–Ω–æ —Å—á–∏—Ç–∞—Ç—å —Ç–æ–ª—å–∫–æ —Å–ª—É—á–∞–∏ –ø–æ–ª–Ω–æ–≥–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è. –û–¥–Ω–∞–∫–æ —Ä–∞–∑—É–º–Ω—ã–º –∫–∞–∂–µ—Ç—Å—è —Å–º–æ—Ç—Ä–µ—Ç—å –∏ –Ω–∞ –¥—Ä—É–≥–∏–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è:

-   —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –æ—Å–Ω–æ–≤—ã
-   —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ —á–∞—Å—Ç–µ—Ä–µ—á–Ω–æ–≥–æ —Ç–µ–≥–∞
-   —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –Ω–∞–±–æ—Ä–∞ –Ω–µ —á–∞—Å—Ç–µ—Ä–µ—á–Ω—ã—Ö —Ç–µ–≥–æ–≤
-   —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –æ—Å–Ω–æ–≤—ã –∏ —á–∞—Å—Ç–µ—Ä–µ—á–Ω–æ–≥–æ —Ç–µ–≥–∞
-   —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ —á–∞—Å—Ç–µ—Ä–µ—á–Ω–æ–≥–æ —Ç–µ–≥–∞ –∏ –Ω–∞–±–æ—Ä–∞ –Ω–µ —á–∞—Å—Ç–µ—Ä–µ—á–Ω—ã—Ö —Ç–µ–≥–æ–≤

–ö—Ä–æ–º–µ —Ç–æ–≥–æ, –º–æ–∂–Ω–æ –µ—â–µ –ø—Ä–æ–≤–µ—Ä—è—Ç—å —Ä–∞–±–æ—Ç—É –º–æ—Ä—Ñ–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–∞—Ç–æ—Ä–∞ (*—Ä—É–∫–∞–º–∏* \<-\> *—Ä—É–∫-–∞–º–∏*).

–í–æ—Ç –∫–∞–∫ –º–æ–∂–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å —Ç–∞–±–ª–∏—Ü–∞ —Å –∑–æ–ª–æ—Ç—ã–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–º. –Ø –Ω–∞–º–µ—Ä–µ–Ω–Ω–æ –≤–≤–µ–ª –Ω–µ—Å–æ—Å—Ç—ã–∫–æ–≤–∫–∏:

-   —Ç–µ–≥ `PRON` –≤–º–µ—Å—Ç–æ `PR`;
-   —Ñ–æ—Ä–º–∞ *–≥–ª–∞–≥–æ–ª* –∏–º–µ–µ—Ç –ª–∏—à—å –æ–¥–∏–Ω —Ç–µ–≥ `<a—Å—Å>`, –∞ —Ç–µ–≥ `<sg>` –ø—Ä–æ–ø—É—â–µ–Ω;
-   –≤ —Ñ–æ—Ä–º–µ *—Ä–∞—Å—Å–∫–∞–∑* –ø–µ—Ä–µ–ø—É—Ç–∞–Ω –ø–æ—Ä—è–¥–æ–∫ —Ç–µ–≥–æ–≤ (`sg, nom` –≤–º–µ—Å—Ç–æ `nom, sg`).

```{r}
library(tidyverse)
read_csv("examples/08_gold_standard.csv")
```

–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, –Ω–∞–º –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ –∫–∞–∫–æ–≥–æ-—Ç–æ –µ–¥–∏–Ω–æ–≥–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π –±—ã –ø–æ–¥—Å—á–∏—Ç—ã–≤–∞–ª –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –º–µ—Ç—Ä–∏–∫–∏, –ø–æ—ç—Ç–æ–º—É –≤–æ—Ç –Ω–µ–∫–æ—Ç–æ—Ä—ã–π –∫–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –¥–µ–ª–∞–µ—Ç —ç—Ç–æ –¥–ª—è

-   –æ—Å–Ω–æ–≤;
-   —á–∞—Å—Ç–µ—Ä–µ—á–Ω—ã—Ö —Ç–µ–≥–æ–≤;
-   –Ω–µ —á–∞—Å—Ç–µ—Ä–µ—á–Ω—ã—Ö —Ç–µ–≥–æ–≤;
-   –≤—Å–µ–≥–æ –≤–º–µ—Å—Ç–µ.

–ï—Å–ª–∏ –±—É–¥–µ—Ç–µ –¥–µ–ª–∞—Ç—å —Å–∞–º–∏, –Ω–µ –∑–∞–±—É–¥—å—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–µ—â–µ–π. –í–æ-–ø–µ—Ä–≤—ã—Ö, –∏–º–µ–µ—Ç —Å–º—ã—Å–ª –≤—ã–∫–∏–Ω—É—Ç—å –¥—É–±–ª–∏–∫–∞—Ç—ã –∏ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–≥–∏. –í–æ-–≤—Ç–æ—Ä—ã—Ö, —Å–ª–µ–¥—É–µ—Ç –ø–æ–º–Ω–∏—Ç—å, —á—Ç–æ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –Ω–µ—á–∞—Å—Ç–µ—Ä–µ—á–Ω—ã—Ö —Ç–µ–≥–æ–≤ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤–µ—Ä–Ω—ã–º, –∞ –Ω–µ –æ—à–∏–±–∫–æ–π, –Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ —Å–ª—É—á–∞–µ –ø—Ä–µ–¥–ª–æ–≥–æ–≤. –í —Ç–∞–∫–æ–º —Å–ª—É—á–∞–µ –Ω–µ —Å—Ç–æ–∏—Ç –≤–≤–æ–¥–∏—Ç—å —à—Ç—Ä–∞—Ñ –∑–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ç–µ–≥–æ–≤.

::: panel-tabset

### R

```{r}
#| echo: true

library(tidyverse)

read_csv("examples/08_gold_standard.csv") |> 
  mutate(tags = map_chr(tags, function(x) str_split(x, ", ") |> unlist() |> unique() |> sort() |> str_c(collapse = ", ")),
         gold_standard = "gold_standard") ->
  gold_standard

system("cat examples/08_corpus.txt | hfst-proc examples/analyzer.hfstol", intern = TRUE) |> 
  str_split(" ") |> 
  unlist() |> 
  enframe() |>
  rename(token_id = name) |> 
  mutate(token = str_extract(value, "(?<=\\^).*?(?=/)"),
         analysis = str_remove(value, "^.*?/"),
         analysis = str_remove(analysis, "\\$"),
         analysis = str_split(analysis, "/")) |> 
  unnest_longer(analysis) |> 
  mutate(stem = str_remove_all(analysis, "<.*?>"),
         stem = if_else(str_detect(stem, "\\*"), "", stem),
         stem = if_else(is.na(stem), "", stem),
         pos = str_extract(analysis, "(<N>)|(<V>)|(<PRON>)|(<ADV>)|(<CONJ>)|(<PREP>)"),
         pos = if_else(is.na(pos), "", pos),
         tags = str_remove(analysis, pos),
         tags = str_remove(tags, stem),
         tags = if_else(is.na(tags), "", tags),
         tags = str_remove_all(tags, "(^<)|(>$)"),
         pos = str_remove_all(pos, "[<>]"),
         tags = map_chr(tags, function(x) str_split(x, "><") |> unlist() |> unique() |> sort() |> str_c(collapse = ", ")),
         analyzer = "analyzer") |> 
  select(token_id, token, stem, pos, tags, analyzer) ->
  analysis
  
analysis |> 
  full_join(gold_standard) |> 
  distinct() |> 
  arrange(token_id) |> 
  count(analyzer, gold_standard) |> 
  mutate(measure = case_when(!is.na(analyzer) & !is.na(gold_standard) ~ "TP",
                             is.na(analyzer) & !is.na(gold_standard) ~ "FN",
                             !is.na(analyzer) & is.na(gold_standard) ~ "FP",
                             is.na(analyzer) & is.na(gold_standard) ~ "TN")) |> 
  select(measure, n) |> 
  pivot_wider(names_from = measure, values_from = n) |> 
  summarise(overall_precision = TP/(TP+FP),
            overall_recall = TP/(TP+FN),
            overall_F_1 = 2*(overall_precision*overall_recall)/(overall_precision+overall_recall))
  
analysis |> 
  select(token_id, token, stem, analyzer) |> 
  full_join(gold_standard |> select(token_id, token, stem, gold_standard)) |> 
  distinct() |> 
  arrange(token_id) |> 
  count(analyzer, gold_standard) |> 
  mutate(measure = case_when(!is.na(analyzer) & !is.na(gold_standard) ~ "TP",
                             is.na(analyzer) & !is.na(gold_standard) ~ "FN",
                             !is.na(analyzer) & is.na(gold_standard) ~ "FP",
                             is.na(analyzer) & is.na(gold_standard) ~ "TN")) |> 
  select(measure, n) |> 
  pivot_wider(names_from = measure, values_from = n) |> 
  summarise(stem_precision = TP/(TP+FP),
            stem_recall = TP/(TP+FN),
            stem_F_1 = 2*(stem_precision*stem_recall)/(stem_precision+stem_recall))

analysis |> 
  select(token_id, token, stem, pos, analyzer) |> 
  full_join(gold_standard |> select(token_id, token, stem, pos, gold_standard)) |> 
  distinct() |> 
  arrange(token_id) |> 
  count(analyzer, gold_standard) |> 
  mutate(measure = case_when(!is.na(analyzer) & !is.na(gold_standard) ~ "TP",
                             is.na(analyzer) & !is.na(gold_standard) ~ "FN",
                             !is.na(analyzer) & is.na(gold_standard) ~ "FP",
                             is.na(analyzer) & is.na(gold_standard) ~ "TN")) |> 
  select(measure, n) |> 
  pivot_wider(names_from = measure, values_from = n) |> 
  summarise(stem_pos_precision = TP/(TP+FP),
            stem_pos_recall = TP/(TP+FN),
            stem_pos_F_1 = 2*(stem_pos_precision*stem_pos_recall)/(stem_pos_precision+stem_pos_recall))

analysis |> 
  select(token_id, tags, analyzer) |> 
  full_join(gold_standard |> select(token_id, tags, gold_standard)) |> 
  distinct() |> 
  arrange(token_id) |> 
  count(analyzer, gold_standard) |> 
  mutate(measure = case_when(!is.na(analyzer) & !is.na(gold_standard) ~ "TP",
                             is.na(analyzer) & !is.na(gold_standard) ~ "FN",
                             !is.na(analyzer) & is.na(gold_standard) ~ "FP",
                             is.na(analyzer) & is.na(gold_standard) ~ "TN")) |> 
  select(measure, n) |> 
  pivot_wider(names_from = measure, values_from = n) |> 
  summarise(tags_precision = TP/(TP+FP),
            tags_recall = TP/(TP+FN),
            tags_F_1 = 2*(tags_precision*tags_recall)/(tags_precision+tags_recall))
```

### Python
:::

–ö–∞–∫ –∏ –≤ —Å–ª—É—á–∞–µ, –æ–ø–∏—Å–∞–Ω–Ω–æ–º –≤—ã—à–µ, –º–æ–∂–µ–Ω–æ —Ä–∞–∑–ª–∏—á–∞—Ç—å precision~1~, recall~1~ –∏ F~1~-–º–µ—Ä—É~1~ –∏ –∏—Ö –∞–Ω–∞–ª–æ–≥–∏ —Å —Å—É—Ñ–∏–∫—Å–æ–º ~2~, –µ—Å–ª–∏ —É–¥–∞–ª—è—Ç—å —ç—Ñ—Ñ–µ–∫—Ç —á–∞—Å—Ç–æ—Ç–Ω–æ—Å—Ç–∏.

## –†–∞–∑–≤–∏—Ç–∏–µ –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä–∞ {#sec-tests}

–°–æ–∑–¥–∞–Ω–∏–µ –º–æ—Ä—Ñ–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –ø–∞—Ä—Å–µ—Ä–∞, —Å–æ–≥–ª–∞—Å–Ω–æ –º–æ–∏–º –æ–∂–∏–¥–∞–Ω–∏—è–º, —ç—Ç–æ –º–Ω–æ–≥–æ—Å—Ç—É–ø–µ–Ω—á–∞—Ç–∞—è –ø—Ä–æ—Ü–µ–¥—É—Ä–∞, –∫–æ—Ç–æ—Ä–∞—è –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è —Ä–∞–±–æ—Ç—É —Å –≥—Ä–∞–º–º–∞—Ç–∏–∫–∞–º–∏, —Å–ª–æ–≤–∞—Ä–µ–º –∏ –ø—Ä–æ–≤–µ—Ä–∫–æ–π –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –º–µ—Ä –∫–∞—á–µ—Å—Ç–≤–∞ –Ω–∞ –∫–æ—Ä–ø—É—Å–µ. –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –±–µ–∑ —Ç–æ–≥–æ –∏–ª–∏ –∏–Ω–æ–≥–æ —Ä–µ—Å—É—Ä—Å–∞ –≤–æ–∑–º–æ–∂–Ω–∞, –Ω–æ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É—Å–ª–æ–∂–Ω—è–µ—Ç —Ä–∞–±–æ—Ç—É. –≠—Ç–æ—Ç —Ñ–∞–∫—Ç –Ω–µ–º–Ω–æ–≥–æ –ø–æ–¥—Ä—ã–≤–∞–µ—Ç –Ω–∞—à —Ç–µ–∑–∏—Å –æ —Ç–æ–º, —á—Ç–æ —Ç—Ä–∞–Ω—Å–¥—å—é—Å–µ—Ä—ã —Ö–æ—Ä–æ—à–∏ –≤ —Ç–µ—Ö —Å–ª—É—á–∞—è—Ö, –∫–æ–≥–¥–∞ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –Ω–µ–π—Ä–æ—Å–µ—Ç–µ–π. –í –ª—é–±–æ–º —Å–ª—É—á–∞–µ, –ø–æ–ª—É—á–∏–≤—à–∏–π—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ –¥—É—Ö—É –±—É–¥–µ—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –±–ª–∏–∂–µ –∫ –ª–∏–Ω–≥–≤–∏—Å—Ç–∏—á–µ—Å–∫–æ–º—É –æ–ø–∏—Å–∞–Ω–∏—é, –ø–æ—ç—Ç–æ–º—É –º—ã –Ω–∞–∑—ã–≤–∞–µ–º –µ–≥–æ –∏–Ω–æ–≥–¥–∞ *–º–∞—à–∏–Ω–æ—á–∏—Ç–∞–µ–º—ã–º –ª–∏–Ω–≥–≤–∏—Å—Ç–∏—á–µ—Å–∫–∏–º –æ–ø–∏—Å–∞–Ω–∏–µ–º*. –ö–∞–∫ –∏ –≤ –¥—Ä—É–≥–∏—Ö –≤–∏–¥–∞—Ö —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏, –∏–º–µ–µ—Ç —Å–º—ã—Å–ª –ø–æ–∫—Ä—ã–≤–∞—Ç—å –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã –∫–æ–¥–∞ —Ç–µ—Å—Ç–∞–º–∏. –î–ª—è —ç—Ç–æ–≥–æ –¥–∞–∂–µ –ø—Ä–∏–¥—É–º–∞–ª–∏ —Å–≤–æ—é –º–µ—Ä—É --- [code coverage](https://en.wikipedia.org/wiki/Code_coverage), –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–æ–ª—é –∫–æ–¥–∞, –ø–æ–∫—Ä—ã—Ç–æ–≥–æ —Ç–µ—Å—Ç–∞–º–∏. –ö–æ–Ω–µ—á–Ω–æ, —Ç–∞–∫–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –Ω–µ –±—É–¥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å —Ç–µ–º–∏ –ø—Ä–æ–≥—Ä–∞–º–º–∞–º–∏, –∫–æ—Ç–æ—Ä—ã–µ –º—ã –æ–±—Å—É–∂–¥–∞–ª–∏, –æ–¥–Ω–∞–∫–æ –≤—Å–µ —Ä–∞–≤–Ω–æ, –∏–º–µ–µ—Ç —Å–º—ã—Å–ª —Å–æ–∑–¥–∞–≤–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É —Å —Ñ–æ—Ä–º–∞–º–∏ –∏ –æ–∂–∏–¥–∞–µ–º—ã–º–∏ —Ä–∞–∑–±–æ—Ä–∞–º–∏, —á—Ç–æ–±—ã –º–æ–∂–Ω–æ –±—ã–ª–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–µ –ø–æ–ª–æ–º–∞–ª–∏ –ª–∏ –º—ã —á—Ç–æ-—Ç–æ, –∏–∑–º–µ–Ω—è—è `twol` –ø—Ä–∞–≤–∏–ª–∞. –¢–∞–∫–æ–≥–æ —Ä–æ–¥–∞ –ø—Ä–æ–≤–µ—Ä–∫—É –ª–µ–≥–∫–æ –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å –≤ –≤–∏–¥–µ —Ñ–∞–π–ª–∞ —Å–æ —Å–ø–∏—Å–∫–æ–º —Ñ–æ—Ä–º –≤ —Ñ–æ—Ä–º–∞—Ç–µ, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–¥–∞–µ—Ç –ø—Ä–æ–≥—Ä–∞–º–º–∞ `hfst-fst2strings`, –∏ –¥–∞–ª—å—à–µ –ø—Ä–∏ –ø–æ–º–æ—â–∏ `grep` —Å–º–æ—Ç—Ä–µ—Ç—å, –µ—Å—Ç—å –ª–∏ –∑–∞–ø–∏—Å–∞–Ω–Ω—ã–µ —Ä–∞–∑–±–æ—Ä—ã –≤ –≤—ã–¥–∞—á–µ `hfst-fst2strings`.

```{{shell}}
grep -xvf file_with_tests.txt generated_forms.txt
```

–í –∫–∞–∫–æ–π-—Ç–æ –º–æ–º–µ–Ω—Ç –º–æ–∂–µ—Ç –Ω–∞—Å—Ç—É–ø–∏—Ç—å —Å–∏—Ç—É–∞—Ü–∏—è, –∫–æ–≥–¥–∞ –æ—Å–Ω–æ–≤–Ω—ã–µ —á–∞—Å—Ç–∏ —Ä–µ—á–∏ —Å–¥–µ–ª–∞–Ω—ã –∏ –¥–æ–ø–æ–ª–Ω–µ–Ω—ã –¥–∞–Ω–Ω—ã–º–∏ —Å–ª–æ–≤–∞—Ä–µ–π. –í —Ç–∞–∫–æ–º —Å–ª—É—á–∞–µ –æ—Å—Ç–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–∏—Å—Ö–æ–¥—è—â–µ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–µ—Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–Ω—ã–µ —Ñ–æ—Ä–º—ã, —á—Ç–æ–±—ã —Ä–∞–±–æ—Ç–∞—Ç—å —Å –µ–¥–∏–Ω–∏—Ü–∞–º–∏, –∫–æ—Ç–æ—Ä—ã–µ, —Å–æ–≥–ª–∞—Å–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—é –¶–∏–ø—Ñ–∞, —Å–∏–ª—å–Ω–µ–µ –≤—Å–µ–≥–æ —É–≤–µ–ª–∏—á–∏–≤–∞—é—Ç –º–µ—Ç—Ä–∏–∫–∏.

```{r}
system('rm -f examples/*.hfstol')
```
